# 数据访问逻辑和业务逻辑的区别

数据访问逻辑和业务逻辑分别代表了**不同层次的代码逻辑**，用于**将系统的不同功能进行分层和分工**，提高系统的可维护性和可扩展性。

## 数据访问逻辑

数据访问逻辑（Data Access Logic）指的是**与数据存储相关**的代码逻辑，主要用于实现对数据的**增删改查**等操作。

数据访问逻辑的代码通常包含了**数据库连接、SQL语句的编写、数据查询和更新**等操作。

在一个系统中，数据访问逻辑通常被封装在**DAO或Repository层**中，以便进行统一管理和复用。

## 业务逻辑

业务逻辑（Business Logic）指的是与业务相关的代码逻辑，主要用于实现**业务需求**的处理。

业务逻辑的代码通常包含了业务规则的定义、业务数据的处理和业务流程的控制等内容。

在一个系统中，业务逻辑通常被封装在**Service层**中，与**Controller层和DAO/Repository层**进行交互。

### 复杂的业务场景示例

假设我们有一个电商平台，需要实现一个下单流程。在这个场景下，业务逻辑可以被划分为多个步骤，每个步骤都包含了一些复杂的业务规则和流程。

以下是可能涉及的一些业务逻辑步骤：

- 商品信息检查：用户提交订单后，需要先检查商品信息是否正确、商品是否下架、库存是否充足等。如果商品信息有误，需要将错误信息返回给用户，让用户进行修改。

- 地址信息检查：用户下单时需要填写收货地址等信息，需要检查地址信息是否完整、是否符合规范等。如果地址信息有误，需要将错误信息返回给用户，让用户进行修改。

- 价格计算：在用户下单时，需要计算订单的总价。价格计算涉及到多个因素，如商品价格、优惠券、满减活动等。需要根据不同的规则进行计算，最终得出订单的总价。

- 支付流程：用户下单后需要进行支付，支付流程包括选择支付方式、支付金额的计算、支付状态的更新等。需要与支付渠道进行交互，保证支付流程的安全性和稳定性。

- 库存扣减：在用户下单后，需要扣减商品库存。需要考虑多种情况，如库存不足、并发下单等，保证库存的正确性和可靠性。

- 订单状态更新：在用户下单成功后，需要将订单状态更新为待发货状态。在订单发货、签收、完成等不同状态下，需要进行相应的状态更新和处理。


以上仅是一个简单的例子，实际的业务逻辑可能更加复杂和多样化。

## 两者的交互作用

在实际的开发中，数据访问逻辑和业务逻辑需要分别处理，以便进行分工和协作。

具体来说，数据访问逻辑主要负责与数据存储打交道，而业务逻辑则负责处理业务需求和实现业务流程。当数据访问逻辑需要查询或更新数据时，业务逻辑可以调用相应的数据访问逻辑方法进行处理，从而实现整个系统的功能需求。

## 业务逻辑和数据访问逻辑分离的必要性

早年的JDBC就是将二者放在一起进行编码, 这样**需要在代码中写sql语句**, 而这样会带来以下**劣势和困扰**:

1. 代码可读性较差：业务逻辑中包含了数据访问逻辑，使得**代码职责不够清晰**，容易让代码变得冗长和混乱，使得代码可读性降低。
2. 代码可维护性差：如果在业务逻辑中包含数据访问逻辑，**当需要修改数据库访问逻辑时，需要同时修改业务逻辑的代码**，这会带来较高的代码维护成本和风险。
3. 可测试性差：在业务逻辑中包含数据访问逻辑，会**使得代码的测试变得更加困难**，需要花费更多的精力进行单元测试和集成测试。
4. 代码可扩展性差：如果在业务逻辑中包含数据访问逻辑，**当需要添加新的数据库访问逻辑时，需要修改业务逻辑的代码**，这会带来较高的代码扩展成本和风险。
5. 业务逻辑和数据访问逻辑的**耦合度较高**：在业务逻辑中包含数据访问逻辑，会使得业务逻辑和数据访问逻辑的耦合度变得较高，**使得代码变得更加难以维护和扩展**, 即第二点和第四点。